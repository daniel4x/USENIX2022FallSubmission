T1	Report 893 1003	MalBus: Popular South Korean Bus App Series in Google Play Found Dropping Malware After 5 Years of Development
T2	Organization 1024 1030	McAfee
T3	Time 1034 1046	Feb 04, 2019
T4	Organization 1049 1078	McAfee’s Mobile Research team
T5	OperatingSystem 1115 1122	Android
T6	AttackPattern_SmallDescription 1135 1199	masquerading as a plugin for a transportation application series
T7	Country 1215 1227	South Korean
T8	Country 1301 1312	South Korea
T9	HostingMalware 1451 1462	Google Play
T10	Time 1469 1473	2013
T11	Time 1500 1504	2017
T12	HostingMalware 1554 1565	Google Play
T13	HostingMalware 1920 1931	Google Play
T14	HostingMalware 1981 1992	Google Play
T15	Application 2001 2010	Daegu Bus
T16	AttackPattern_SmallDescription 2106 2215	downloads an additional payload from hacked web servers which includes the fake plugin we originally acquired
T17	AttackPattern_SmallDescription 2312 2502	acts as a plugin of the transportation application and installs a trojan on the device, trying to phish users to input their Google account password and completely take control of the device
T18	AttackPattern_SmallDescription 2544 2643	uses the native library to take over the device and also deletes the library to hide from detection
T19	AttackPattern_SmallDescription 2645 2727	It uses names of popular South Korean services like Naver, KakaoTalk, Daum and SKT
T20	Country 2670 2682	South Korean
T21	Application 2697 2702	Naver
T22	Application 2704 2714	KakaoTalk,
T23	Application 2715 2719	Daum
T24	Application 2724 2727	SKT
T25	AttackPattern_LargeDescription 3039 3216;3217 3357	When the malicious version of the transportation app is installed, it checks whether the fake plugin is already installed and, if not, downloads from the server and installs it. After that, it downloads and executes an additional native trojan binary which is similar to the trojan which is dropped by the fake plugin.
T26	AttackPattern_SmallDescription 3109 3215	checks whether the fake plugin is already installed and, if not, downloads from the server and installs it
T27	AttackPattern_SmallDescription 3232 3289	downloads and executes an additional native trojan binary
T28	AttackPattern_SmallDescription 3387 3445	connects with the C2 servers and handles received commands
T29	HostingMalware 3585 3596	Google Play
T30	Indicator 3771 3785	libAudio3.0.so
T31	Indicator 3874 3890	BaseMainActivity
T32	AttackPattern_SmallDescription 3912 3987	loads the malicious library and calls startUpdate() and updateApplication()
T33	Indicator 3950 3963	startUpdate()
T34	Indicator 3968 3987	updateApplication()
T35	AttackPattern_SmallDescription 4071 4242	checks whether the app is correctly installed by checking for the existence of a specific flag file named “background.png” and whether the fake plugin is installed already
T36	Filename 4178 4192	background.png
T37	AttackPattern_SmallDescription 4287 4384	fake plugin is downloaded from a hacked web server and installed after displaying a toast message
T38	AttackPattern_SmallDescription 4400 4445	updateApplication() downloads a native binary
T39	AttackPattern_SmallDescription 4504 4591	downloaded file (saved as libSound1.1.so) is then deleted after being loaded into memor
T40	Filename 4530 4544	libSound1.1.so
T41	AttackPattern_SmallDescription 4610 4662	executes an exported function which acts as a trojan
T42	AttackPattern_SmallDescription 4855 4932	fake plugin is downloaded from a hacked web server with file extension “.mov”
T43	AttackPattern_SmallDescription 4998 5067	displays a toast message saying the plugin was successfully installed
T44	Country 5072 5078	Korean
T45	AttackPattern_SmallDescription 5084 5125	calls a native function named playMovie()
T46	Filename 5224 5235	LibMovie.so
T47	AttackPattern_SmallDescription 5278 5376	drops a malicious trojan to the current running app’s directory masquerading as libpng.2.1.so file
T48	Filename 5358 5376	libpng.2.1.so file
T49	AttackPattern_SmallDescription 5411 5474	embedded in the LibMovie.so xor’ed, which is decoded at runtime
T50	Filename 5427 5438	LibMovie.so
T51	AttackPattern_SmallDescription 5506 5609	address of the exported function “Libfunc” in the dropped trojan is dynamically retrieved using dlsym()
T52	AttackPattern_SmallDescription 5615 5709	dropped binary in the filesystem is deleted to avoid detection and finally Libfunc is executed
T53	AttackPattern_SmallDescription 5795 5860	tries to access the “naver.property” file on an installed SD Card
T54	Filename 5816 5830	naver.property
T55	AttackPattern_SmallDescription 5902 5976	tries starting “.KaKaoTalk” activity which displays a Google phishing page
T56	Application 5918 5928	.KaKaoTalk
T57	Organization 5956 5962	Google
T58	Application 6184 6194	.KaKaoTalk
T59	OperatingSystem 6230 6237	Android
T60	Application 6257 6267	.KaKaoTalk
T61	Application 6317 6326	KakaoTalk
T62	AttackPattern_SmallDescription 6317 6480	KakaoTalk class opens a local HTML file, javapage.html, with the user’s email address registered on the infected device automatically set to log into their account
T63	Filename 6358 6371	javapage.html
T64	AttackPattern_SmallDescription 6510 6541	loads malicious local html file
T65	AttackPattern_SmallDescription 6556 6624	email address is set to the local page through a JavaScript function
T66	AttackPattern_SmallDescription 6679 6724	fake Korean Google login website is displayed
T67	Organization 6691 6697	Google
T68	AttackPattern_SmallDescription 6764 6813	shows crafted Google login page with user account
T69	Organization 6778 6784	Google
T70	Organization 6866 6872	Google
T71	AttackPattern_SmallDescription 6917 6959	Steal victim’s Google account and password
T72	Organization 6932 6938	Google
T73	AttackPattern_SmallDescription 6961 7009	Request password recovery for a specific account
T74	AttackPattern_SmallDescription 7011 7070	Set recovery email address when creating new Google account
T75	Organization 7056 7062	Google
T76	AttackPattern_SmallDescription 7102 7117	phishing attack
T77	AttackPattern_SmallDescription 7130 7230	malware authors tried to set their own email as the recovery address on Google’s legitimate services
T78	Organization 7202 7208	Google
T79	AttackPattern_SmallDescription 7338 7431	link is opened with the malware author’s email address as a parameter of RecoveryEmailAddress
T80	AttackPattern_SmallDescription 7469 7539	attempts to set recovery email address for new Google account creation
T81	Organization 7516 7522	Google
T82	Organization 7755 7761	Google
T83	AttackPattern_SmallDescription 7777 7926	when “Libfunc” function of the trojan (dropped by the fake plugin or downloaded from the server) is executed, the mobile phone is totally compromised
T84	AttackPattern_SmallDescription 7931 7996	receives commands from the following hardcoded list of C2 servers
T85	CommandAndControl 7986 7996	C2 servers
T86	AttackPattern_SmallDescription 8007 8085	functionality of the trojan is implemented in a function called “doMainProc()”
T87	CommandAndControl 8247 8257	C2 servers
T88	CommandAndControl 8288 8298	C2 servers
T89	CommandAndControl 8349 8359	C2 Servers
T90	CommandAndControl 8420 8429	C2 server
T91	AttackPattern_SmallDescription 8943 9055	does some initialization, like sending device information files to the server and checking the UID of the device
T92	AttackPattern_SmallDescription 9062 9119	after the UID checking returns a 1 does it enter the loop
T93	AttackPattern_SmallDescription 9203 9221	directory indexing
T94	AttackPattern_SmallDescription 9277 9315	saved in a file named “kakao.property”
T95	Filename 9300 9314	kakao.property
T96	AttackPattern_SmallDescription 9373 9475	checks the file with specific keywords and if it matches, uploads the file to the remote upload server
T97	HostingMalware 10018 10029	Google Play
T98	AttackPattern_SmallDescription 10188 10314	searching the victim’s devices for files related to the military and politics, likely trying to leak confidential information.
T99	VirusScanner 10437 10459	McAfee Mobile Security
T100	Malware 10483 10497	Android/MalBus
T101	VirusScanner 10609 10631	McAfee Mobile Security
T102	Hash 10726 10790	19162b063503105fdc1899f8f653b42d1ff4fcfcdf261f04467fad5f563c0270
T103	Hash 10793 10857	bed3e665d2b5fd53aab19b8a62035a5d9b169817adca8dfb158e3baf71140ceb
T104	Hash 10860 10924	3252fbcee2d1aff76a9f18b858231adb741d4dc07e803f640dcbbab96db240f9
T105	Hash 10927 10991	e71dc11e8609f6fd84b7af78486b05a6f7a2c75ed49a46026e463e9f86877801
T106	Hash 11012 11076	ecb6603a8cd1354c9be236a3c3e7bf498576ee71f7c5d0a810cb77e1138139ec
T107	Hash 11079 11143	b8b5d82eb25815dd3685630af9e9b0938bccecb3a89ce0ad94324b12d25983f0
T108	Hash 11174 11238	b9d9b2e39247744723f72f63888deb191eafa3ffa137a903a474eda5c0c335cf
T109	Hash 11241 11305	12518eaa24d405debd014863112a3c00a652f3416df27c424310520a8f55b2ec
T110	Hash 11308 11372	91f8c1f11227ee1d71f096fd97501c17a1361d71b81c3e16bcdabad52bfa5d9f
T111	Hash 11375 11439	20e6391cf3598a517467cfbc5d327a7bb1248313983cba2b56fd01f8e88bb6b9
R1	has Arg1:T25 Arg2:T26	
R2	has Arg1:T25 Arg2:T27	
R3	has Arg1:T25 Arg2:T28	
R4	uses Arg1:T100 Arg2:T6	
R5	has Arg1:T100 Arg2:T10	
R6	has Arg1:T100 Arg2:T11	
R7	uses Arg1:T100 Arg2:T16	
R8	uses Arg1:T100 Arg2:T17	
R9	uses Arg1:T100 Arg2:T18	
R10	uses Arg1:T100 Arg2:T19	
R11	uses Arg1:T100 Arg2:T25	
R12	indicatedBy Arg1:T100 Arg2:T30	
R13	indicatedBy Arg1:T100 Arg2:T31	
R14	uses Arg1:T100 Arg2:T32	
R15	indicatedBy Arg1:T100 Arg2:T33	
R16	indicatedBy Arg1:T100 Arg2:T34	
R17	uses Arg1:T100 Arg2:T35	
R18	indicatedBy Arg1:T100 Arg2:T36	
R19	uses Arg1:T100 Arg2:T37	
R20	uses Arg1:T100 Arg2:T38	
R21	uses Arg1:T100 Arg2:T39	
R22	indicatedBy Arg1:T100 Arg2:T40	
R23	uses Arg1:T100 Arg2:T41	
R24	uses Arg1:T100 Arg2:T42	
R25	uses Arg1:T100 Arg2:T43	
R26	uses Arg1:T100 Arg2:T45	
R27	indicatedBy Arg1:T100 Arg2:T46	
R28	uses Arg1:T100 Arg2:T47	
R29	indicatedBy Arg1:T100 Arg2:T48	
R30	uses Arg1:T100 Arg2:T49	
R31	indicatedBy Arg1:T100 Arg2:T50	
R32	uses Arg1:T100 Arg2:T51	
R33	uses Arg1:T100 Arg2:T52	
R34	uses Arg1:T100 Arg2:T53	
R35	indicatedBy Arg1:T100 Arg2:T54	
R36	uses Arg1:T100 Arg2:T55	
R37	uses Arg1:T100 Arg2:T56	
R38	uses Arg1:T100 Arg2:T58	
R39	uses Arg1:T100 Arg2:T60	
R40	uses Arg1:T100 Arg2:T61	
R41	uses Arg1:T100 Arg2:T62	
R42	indicatedBy Arg1:T100 Arg2:T63	
R43	uses Arg1:T100 Arg2:T64	
R44	uses Arg1:T100 Arg2:T65	
R45	uses Arg1:T100 Arg2:T66	
R46	uses Arg1:T100 Arg2:T68	
R47	uses Arg1:T100 Arg2:T71	
R48	uses Arg1:T100 Arg2:T73	
R49	uses Arg1:T100 Arg2:T74	
R50	uses Arg1:T100 Arg2:T76	
R51	has Arg1:T100 Arg2:T77	
R52	uses Arg1:T100 Arg2:T79	
R53	uses Arg1:T100 Arg2:T80	
R54	uses Arg1:T100 Arg2:T83	
R55	uses Arg1:T100 Arg2:T84	
R56	uses Arg1:T100 Arg2:T86	
R57	communicatesWith Arg1:T100 Arg2:T87	
R58	communicatesWith Arg1:T100 Arg2:T88	
R59	communicatesWith Arg1:T100 Arg2:T89	
R60	communicatesWith Arg1:T100 Arg2:T90	
R61	uses Arg1:T100 Arg2:T91	
R62	uses Arg1:T100 Arg2:T92	
R63	uses Arg1:T100 Arg2:T93	
R64	uses Arg1:T100 Arg2:T94	
R65	indicatedBy Arg1:T100 Arg2:T95	
R66	uses Arg1:T100 Arg2:T96	
R67	uses Arg1:T100 Arg2:T97	
R68	uses Arg1:T100 Arg2:T98	
R69	indicatedBy Arg1:T100 Arg2:T102	
R70	indicatedBy Arg1:T100 Arg2:T103	
R71	indicatedBy Arg1:T100 Arg2:T104	
R72	indicatedBy Arg1:T100 Arg2:T105	
R73	indicatedBy Arg1:T100 Arg2:T106	
R74	indicatedBy Arg1:T100 Arg2:T107	
R75	indicatedBy Arg1:T100 Arg2:T108	
R76	indicatedBy Arg1:T100 Arg2:T109	
R77	indicatedBy Arg1:T100 Arg2:T110	
R78	indicatedBy Arg1:T100 Arg2:T111	
